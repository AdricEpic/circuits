<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>circuits.lib.web.httpauth</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="circuits-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://trac.softcircuit.com.au/circuits/">circuits</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="circuits-module.html">Package&nbsp;circuits</a> ::
        <a href="circuits.lib-module.html">Package&nbsp;lib</a> ::
        <a href="circuits.lib.web-module.html">Package&nbsp;web</a> ::
        Module&nbsp;httpauth
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module httpauth</h1><p class="nomargin-top"></p>
<pre class="literalblock">

httpauth modules defines functions to implement HTTP Digest Authentication (RFC 2617).
This has full compliance with 'Digest' and 'Basic' authentication methods. In
'Digest' it supports both MD5 and MD5-sess algorithms.

Usage:

    First use 'doAuth' to request the client authentication for a
    certain resource. You should send an httplib.UNAUTHORIZED response to the
    client so he knows he has to authenticate itself.
    
    Then use 'parseAuthorization' to retrieve the 'auth_map' used in
    'checkResponse'.

    To use 'checkResponse' you must have already verified the password associated
    with the 'username' key in 'auth_map' dict. Then you use the 'checkResponse'
    function to verify if the password matches the one sent by the client.

SUPPORTED_ALGORITHM - list of supported 'Digest' algorithms
SUPPORTED_QOP - list of supported 'Digest' 'qop'.

</pre>

<hr />
<div class="fields">      <p><strong>Author:</strong>
        Tiago Cogumbreiro &lt;cogumbreiro@users.sf.net&gt;
      </p>
      <p><strong>License:</strong>
        Copyright (c) 2005, Tiago Cogumbreiro 
        &lt;cogumbreiro@users.sf.net&gt;
        All rights reserved.
        
        Redistribution and use in source and binary forms, with or without 
        modification, 
        are permitted provided that the following conditions are met:
        
            * Redistributions of source code must retain the above 
        copyright notice, 
              this list of conditions and the following disclaimer.
            * Redistributions in binary form must reproduce the above 
        copyright notice, 
              this list of conditions and the following disclaimer in the 
        documentation 
              and/or other materials provided with the distribution.
            * Neither the name of Sylvain Hellegouarch nor the names of his
        contributors 
              may be used to endorse or promote products derived from this 
        software 
              without specific prior written permission.
        
        THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
        &quot;AS IS&quot; AND 
        ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, 
        THE IMPLIED 
        WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE 
        ARE 
        DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS 
        BE LIABLE 
        FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR 
        CONSEQUENTIAL 
        DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE 
        GOODS OR 
        SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) 
        HOWEVER 
        CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT 
        LIABILITY, 
        OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT 
        OF THE USE 
        OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH 
        DAMAGE.
      </p>
</div><!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Functions</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="circuits.lib.web.httpauth-module.html#calculateNonce" class="summary-sig-name">calculateNonce</a>(<span class="summary-sig-arg">realm</span>,
        <span class="summary-sig-arg">algorithm</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">MD5</code><code class="variable-quote">'</code></span>)</span><br />
      This is an auxaliary function that calculates 'nonce' value.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="digestAuth"></a><span class="summary-sig-name">digestAuth</span>(<span class="summary-sig-arg">realm</span>,
        <span class="summary-sig-arg">algorithm</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">MD5</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">nonce</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">qop</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">auth</code><code class="variable-quote">'</code></span>)</span><br />
      Challenges the client for a Digest authentication.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="basicAuth"></a><span class="summary-sig-name">basicAuth</span>(<span class="summary-sig-arg">realm</span>)</span><br />
      Challengenes the client for a Basic authentication.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="circuits.lib.web.httpauth-module.html#doAuth" class="summary-sig-name">doAuth</a>(<span class="summary-sig-arg">realm</span>)</span><br />
      'doAuth' function returns the challenge string b giving priority over
      Digest and fallback to Basic authentication when the browser doesn't 
      support the first one.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="circuits.lib.web.httpauth-module.html#parseAuthorization" class="summary-sig-name">parseAuthorization</a>(<span class="summary-sig-arg">credentials</span>)</span><br />
      parseAuthorization will convert the value of the 'Authorization' key 
      in the HTTP header to a map itself.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="circuits.lib.web.httpauth-module.html#md5SessionKey" class="summary-sig-name">md5SessionKey</a>(<span class="summary-sig-arg">params</span>,
        <span class="summary-sig-arg">password</span>)</span><br />
      If the &quot;algorithm&quot; directive's value is 
      &quot;MD5-sess&quot;, then A1 [the session key] is calculated only 
      once - on the first request by the client following receipt of a 
      WWW-Authenticate challenge from the server.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="circuits.lib.web.httpauth-module.html#checkResponse" class="summary-sig-name">checkResponse</a>(<span class="summary-sig-arg">auth_map</span>,
        <span class="summary-sig-arg">password</span>,
        <span class="summary-sig-arg">method</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">GET</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">encrypt</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      'checkResponse' compares the auth_map with the password and 
      optionally other arguments that each implementation might need.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Variables</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="SUPPORTED_ALGORITHM"></a><span class="summary-name">SUPPORTED_ALGORITHM</span> = <code title="('MD5', 'MD5-sess')"><code class="variable-group">(</code><code class="variable-quote">'</code><code class="variable-string">MD5</code><code class="variable-quote">'</code><code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">MD5-sess</code><code class="variable-quote">'</code><code class="variable-group">)</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="SUPPORTED_QOP"></a><span class="summary-name">SUPPORTED_QOP</span> = <code title="('auth', 'auth-int')"><code class="variable-group">(</code><code class="variable-quote">'</code><code class="variable-string">auth</code><code class="variable-quote">'</code><code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">auth-int</code><code class="variable-quote">'</code><code class="variable-group">)</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Function Details</span></td>
</tr>
</table>
<a name="calculateNonce"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">calculateNonce</span>(<span class="sig-arg">realm</span>,
        <span class="sig-arg">algorithm</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">MD5</code><code class="variable-quote">'</code></span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This is an auxaliary function that calculates 'nonce' value. It is 
  used to handle sessions.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="doAuth"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">doAuth</span>(<span class="sig-arg">realm</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>'doAuth' function returns the challenge string b giving priority over 
  Digest and fallback to Basic authentication when the browser doesn't 
  support the first one.</p>
  <p>This should be set in the HTTP header under the key 
  'WWW-Authenticate'.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="parseAuthorization"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">parseAuthorization</span>(<span class="sig-arg">credentials</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>parseAuthorization will convert the value of the 'Authorization' key 
  in the HTTP header to a map itself. If the parsing fails 'None' is 
  returned.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="md5SessionKey"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">md5SessionKey</span>(<span class="sig-arg">params</span>,
        <span class="sig-arg">password</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>If the &quot;algorithm&quot; directive's value is 
  &quot;MD5-sess&quot;, then A1 [the session key] is calculated only once -
  on the first request by the client following receipt of a 
  WWW-Authenticate challenge from the server.</p>
  <p>This creates a 'session key' for the authentication of subsequent 
  requests and responses which is different for each &quot;authentication 
  session&quot;, thus limiting the amount of material hashed with any one 
  key.</p>
  <p>Because the server need only use the hash of the user credentials in 
  order to create the A1 value, this construction could be used in 
  conjunction with a third party authentication service so that the web 
  server would not need the actual password value.  The specification of 
  such a protocol is beyond the scope of this specification.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="checkResponse"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">checkResponse</span>(<span class="sig-arg">auth_map</span>,
        <span class="sig-arg">password</span>,
        <span class="sig-arg">method</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">GET</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">encrypt</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>'checkResponse' compares the auth_map with the password and optionally
  other arguments that each implementation might need.</p>
  <p>If the response is of type 'Basic' then the function has the following
  signature:</p>
  <p>checkBasicResponse (auth_map, password) -&gt; bool</p>
  <p>If the response is of type 'Digest' then the function has the 
  following signature:</p>
  <p>checkDigestResponse (auth_map, password, method = 'GET', A1 = None) 
  -&gt; bool</p>
  <p>The 'A1' argument is only used in MD5_SESS algorithm based responses. 
  Check md5SessionKey() for more info.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="circuits-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://trac.softcircuit.com.au/circuits/">circuits</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Thu Mar 12 14:10:14 2009
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
